<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 5.2.7.2 (Linux)"/>
  <meta name="created" content="2017-10-03T07:57:42.145980894"/>
  <meta name="changed" content="2017-10-04T06:14:03.321983734"/>
</head>
<body>
<h1></h1>
<p>AMIGA DOS</p>
<p>11.01</p>
<p>Fonts</p>
<p>11.02</p>
<p>Speech</p>
<p>11.03</p>
<p>Floating Point Numbers</p>
<p>11.04</p>
<p>Multi-tasking</p>
<p>11.05</p>
<p>Libraries and Devices</p>
<h1 style="page-break-before:always; "></h1>
<p>Fonts</p>
<p>A “font” refers to the physical shape of a set of printed characters. This Chapter explains how to </p>
<p>exploit the ready-made AMOS Professional fonts, how to import new ones, and how to design your </p>
<p>own fonts using the ready-made</p>
<p>Font Editor program.</p>
<p><b>Text Fonts</b></p>
<p>Tile   sets   of   fonts   used   by   commands   like   PRINT,   are   known   as   “text   fonts”,   and   each  AMOS </p>
<p>Professional window can have its own individual set, as required. Styles and special effects for text </p>
<p>fonts are controlled by instructions such as TEXT STYLE and WRITING, which are fully explained in </p>
<p>Chapter 5.6.</p>
<p><b>Graphic Text Fonts</b></p>
<p>Although text fonts are suitable for normal uses, an infinite variety of styles can be achieved by </p>
<p>exploiting the much more flexible category of fonts known as “graphic text”. Text fonts are positioned </p>
<p>by referring to their location in terms of characters, but graphic text can be controlled much more </p>
<p>accurately, because it is positioned using x,y-coordinates numbered in pixels. AMOS Professional </p>
<p>supports the thousands of graphic fonts, available in commercial packages or in the public domain.</p>
<p><b>ROM Fonts</b></p>
<p>There are also alternative fonts built into the Amiga's ROM chips, and these are also available for use </p>
<p>by the AMOS Professional system.</p>
<p>All fonts are referred to by an individual index number in a font list. No matter what type of font is to  </p>
<p>be used, you must first “get” it from wherever it is being stored, and then “set” it, ready for use. Users </p>
<p>who are familiar with the AMOS system will find that the AMOS Professional system for handling </p>
<p>fonts has been streamlined and improved. When a SET FONT command is given, the system will do </p>
<p>an automatic search to see if the required font is already in memory, and if all is well, the specified </p>
<p>font is immediately made available for use. If the required font is not found in the current list of </p>
<p>available fonts, it will be loaded, but the next time it is called by SET FONT there will be no need to </p>
<p>load it again.</p>
<p><b>GET FONTS</b></p>
<p><i>instruction: create a list of available fonts from System disc</i></p>
<p><b>Get Fonts</b></p>
<p>The GET FONTS command creates an internal list of all available fonts on the System disc, and it </p>
<p>should always be called at least once before any changes in settings are made. In practice, you will </p>
<p>probably want to use this instruction at the beginning of a program, so that SET FONT may be used  </p>
<p>freely at any later point.</p>
<p>It is  <b>very</b>  important to remember that if you are distributing run-only or compiled programs to be </p>
<p>used by other people, and these programs make use of alternative fonts, then the required font files </p>
<p><b>must</b> be included.</p>
<p>Get Fonts</p>
<p>For F=0 To 10</p>
<p>Set Font F : T$=“AMOS Professional Font: ”+Str$(F)</p>
<p>Text 0,100,T$</p>
<p>Wait Key : Cls</p>
<p>Next F</p>
<p>11.01.01</p>
<p>F</p>
<p>O</p>
<p>N</p>
<p>T</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Fonts</p>
<p><b>GET DISC FONTS</b></p>
<p><i>instruction: create a list of available fonts from current disc</i></p>
<p><b>Get Disc Fonts</b></p>
<p>This instruction is exactly the same as the GET FONTS command, except that it triggers a search </p>
<p>through the “Fonts” folder of your current disc only. If new fonts are to be used, then they must first </p>
<p>be copied into this folder.</p>
<p><b>GET ROM FONTS</b></p>
<p><i>instruction: create a list of available ROM fonts</i></p>
<p><b>Get Rom Fonts</b></p>
<p>As you might expect, this command produces a list of the fonts that are built into the computer's </p>
<p>ROM chips. At time of writing, the choice is rather limited:</p>
<p>Screen Open 0,640,200,16,Hires</p>
<p>Get Rom Fonts</p>
<p>For A=1 To 10</p>
<p>Set Font A : A$=“Hello, I'm ”+ Font$(A) : Text 0,100,A$</p>
<p>Wait Key : Cls</p>
<p>Next A</p>
<p><b>FONT$</b></p>
<p><i>function: return details of available fonts</i></p>
<p>report$=<b>Font$</b>(font number)</p>
<p>This function is used to examine an existing font list and make a report, giving details of the specified </p>
<p>font number. The report is given as a string of 38 characters, holding the following information: the </p>
<p>name of the font, its physical height in pixels and its status set to either Disc or Rom. For example:</p>
<p>Get Fonts : Set Font 2</p>
<p>Print Font$(2)</p>
<p><b>SET FONT</b></p>
<p><i>instruction: select font for use by Text command</i></p>
<p><b>Set Font</b> font number</p>
<p>This simple command is used to select the character set to be employed by a TEXT instruction, like </p>
<p>this:</p>
<p>Get Fonts</p>
<p>Set Font 2 : Text 100,100,“AMOS” : Set Font 1: Text 100,120,“Professional”</p>
<p>11.01.02</p>
<p>F</p>
<p>O</p>
<p>N</p>
<p>T</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Fonts</p>
<p><b>TEXT</b></p>
<p><i>instruction: print graphical text</i></p>
<p><b>Text</b> x,y,text$</p>
<p>This   command   is   used   to   print   text   at   the   specified  <b>graphical</b>  coordinates.  All   coordinates   are </p>
<p>measured relative to the “baseline” of the current character set, which can be found using the TEXT </p>
<p>BASE function, explained next. Normally, the baseline is the notional line on which all characters sit, </p>
<p>and the “tails” of certain characters (like g,j,p,q and y) drop below this baseline. The next example </p>
<p>demonstrates how text can be placed at any pixel position on the screen:</p>
<p>Do</p>
<p>Ink Rnd(15)+1,Rnd(15) : Text Rnd(320)+1,Rnd(198)+1,“AMOS Professional”</p>
<p>Loop</p>
<p><b>TEXT BASE</b></p>
<p><i>function: return the text base of the current character set</i></p>
<p>baseline=<b>Text base</b></p>
<p>This function is used to get the reference position of the current font's baseline, given as the number  </p>
<p>of pixels between the top of the character, and the point that it will be printed on the screen. It is </p>
<p>similar to the hot-spot of an Object.</p>
<p><b>TEXT LENGTH</b></p>
<p><i>function: return the length of a section of graphical text</i></p>
<p>width=<b>Text Length</b>(text$)</p>
<p>This function returns the number of pixels that make up the width of the characters in the current </p>
<p>font, in a given string. This can vary for the same string, depending on the font in use. Furthermore, </p>
<p>there are special fonts which assign different widths for each character in the same character set, </p>
<p>known as “proportional” fonts. Here is a simple example:</p>
<p>TS=“Centred Text”</p>
<p>L=Text Length(T$)</p>
<p>Text 160-L/2,100,T$</p>
<p><b>Wiping fonts from memory</b></p>
<p>As fonts are called, they build up in memory. Valuable memory is consumed, and it may be necessary </p>
<p>to wipe fonts, using a line like this:</p>
<p>Trap Reserve As Data 10,1000000000</p>
<p>This forces AmigaDOS to clear out all unused memory, which will affect the fonts that have been </p>
<p>stored. Obviously the huge amount of RAM that has been requested cannot possibly be reserved, </p>
<p>even after the fonts have been cleared, and an “out of memory” error will be generated. A TRAP is </p>
<p>included to cater for this event.</p>
<p>11.01.03</p>
<p>F</p>
<p>O</p>
<p>N</p>
<p>T</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Fonts</p>
<p><b>Assigning fonts</b></p>
<p>In the original AMOS system, you were obliged to go back to the Amiga Disc Operating System every </p>
<p>time   that   the   current   font   directory   needed   changing.   With   AMOS   Professional,   the   ASSIGN </p>
<p>instruction solves this problem.</p>
<p><b>ASSIGN</b></p>
<p><i>instruction: assign a name to a file or device</i></p>
<p><b>Assign</b> “Name:” <b>To</b> “New_Pathname”</p>
<p><b>Assign</b> “Name:” <b>To</b> “Device”</p>
<p>Supposing that  you  have an  extensive  library of fonts installed  on  a  hard  disc,  as part of  your </p>
<p>development system, but you are writing programs for users who only have use of the internal floppy </p>
<p>drive. You will need to test your programs with a reduced number of fonts, and employ the internal </p>
<p>drive instead of your hard disc. This is easily achieved with the following line:</p>
<p>Assign “Fonts:” To “Df0:Fonts”</p>
<p>Now, every time that GET FONTS or GET DISC FONTS is called, the internal drive will be used </p>
<p>instead of your hard disc.</p>
<p><b>Converting font coordinates</b></p>
<p>Obviously, with graphic fonts using coordinates measured in pixels, and text fonts positioned by </p>
<p>character coordinates, a set of conversion functions between the two systems is vital.</p>
<p><b>XTEXT</b></p>
<p><b>YTEXT</b></p>
<p><i>functions: convert graphic coordinates to text coordinates</i></p>
<p>text x-coordinate=<b>Xtext</b>(graphic x-coordinate)</p>
<p>text y-coordinate=<b>Ytext</b>(graphic y-coordinate)</p>
<p>These self-explanatory functions convert coordinates from the standard graphical screen coordinates </p>
<p>that   use   pixels,   to   text   coordinates,   that   are   given   in   character   lines   and   column   spacings.   The </p>
<p>resulting text coordinates are relative to the current window, and if the screen coordinate lies outside </p>
<p>of this window, a negative value will be returned.</p>
<p><b>XGRAPHIC</b></p>
<p><b>YGRAPHIC</b></p>
<p><i>functions: convert text coordinates to graphic coordinates</i></p>
<p>graphic x-coordinate=<b>Xtext</b>(text x-coordinate)</p>
<p>graphic y-coordinate=<b>Ytext</b>(text y-coordinate)</p>
<p>This   pair   of   functions   performs   the   conversion   of   text   format   coordinates   to   graphic   format </p>
<p>coordinates, and can be used to position text over an area of graphics on the screen.</p>
<p>11.01.04</p>
<p>F</p>
<p>O</p>
<p>N</p>
<p>T</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Fonts</p>
<p><b>The AMOS Professional Text Font Editor</b></p>
<p>No matter how many fonts are available in your collection, there may be occasions when you need to </p>
<p>create your own character sets, or edit existing fonts for a specific purpose or special effect. Nothing </p>
<p>could be simpler!</p>
<p>The AMOS Professional Text Font Editor is available on your Accessories disc, allowing fast, precise </p>
<p>and fool-proof loading, editing and saving of text fonts.</p>
<p>Load “AMOSPro_Accessories:Font8x8_Editor.AMOS”</p>
<p>The Font Editor screen is divided into three practical areas. The left-hand side of the screen is used to </p>
<p>display an entire character set. The top right-hand area of the screen displays an enlarged 8 x 8 grid, </p>
<p>which holds the individual character to be edited This is the working area. The bottom right-hand </p>
<p>screen contains a simple panel of options.</p>
<p><b>[LOAD FONT]</b></p>
<p>Click on this option now, and a file requester will appear, asking you to load a font for editing. This </p>
<p>may be the Default Font which is available in the APSystem folder, (AMOSPro.Default.Font).</p>
<p>After clicking on your choice of font, the individual characters in the set are displayed on the Font  </p>
<p>Editor working screen, and any of these characters can be selected by the mouse, for your attention.  </p>
<p>As soon as a character is selected, its enlarged image appears in the editing window at the top right-</p>
<p>hand section of the screen.</p>
<p><b>[CLEAR][SET]</b></p>
<p>This pair of options are used to affect all of the pixels that make up the current character, by either </p>
<p>clearing or setting them. Alternatively, individual pixels can be cleared or set by clicking on them with </p>
<p>any mouse button, to toggle their current status.</p>
<p><b>[STORE]</b></p>
<p>The current character also appears in the [STORE] option panel. When you are satisfied with the </p>
<p>edited appearance  of  the  current  character,  click  on  this  panel to  store it  into  the  current  font's </p>
<p>character set, before moving to the next operation.</p>
<p><b>[SAVE FONT]</b></p>
<p>After your editing session is finished, the new font is saved to disc by clicking on this option, and </p>
<p>calling up the familiar file selector. After saving, you can continue the editing process, or call up a </p>
<p>new font to be edited.</p>
<p><b>[QUIT]</b></p>
<p>Select this option to return to the AMOS Professional Edit screen.</p>
<p>You are warned <b>not</b> to destroy the default font, otherwise AMOS Professional will be unusable the </p>
<p>next time it is initialised!</p>
<p>11.01.05</p>
<p>F</p>
<p>O</p>
<p>N</p>
<p>T</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Speech</p>
<p><b>Synthetic speech</b></p>
<p>AMOS Professional programmers are not restricted to printing words on screen. You can command </p>
<p>your Amiga to say them! This can be invaluable for people whose eyesight is impaired, for the </p>
<p>creation of teaching programs for younger users, as well as for adding atmosphere to computer </p>
<p>games and sheer fun. Before uttering its first words of the day, a Narrator device is loaded off disc </p>
<p>automatically, and this takes a few seconds. After that, speech is almost instant. Obviously, hard disc </p>
<p>users must remember to install the Narrator on hard disc before the Amiga will speak.</p>
<p><b>SAY</b></p>
<p><i>instruction: speak a phrase</i></p>
<p><b>Say</b> text$</p>
<p><b>Say</b> text$,<i>mode</i></p>
<p>This is one of the simplest of all AMOS Professional commands to use, and it has one of the most </p>
<p>satisfying   results.   Use   the   SAY   instruction   with   a   string   of   text,   containing   all   the   words   and  </p>
<p>punctuation you want AMOS Professional to speak, like this:</p>
<p>Say “Welcome, everybody!”</p>
<p>Normally,   all   other   instructions,   music   or   sound   effects   will   wait   until  AMOS   Professional   has </p>
<p>finished speaking before they are executed. This default speech mode has a value of zero. By adding </p>
<p>an optional mode value of 1, synthetic speech can be delivered while the rest of the program is being </p>
<p>executed. This will necessarily slow down the relevant routines. To return to the default mode, use a </p>
<p>line like this:</p>
<p>Say “Default mode.”,0</p>
<p>Now get AMOS Professional to say anything you like, using the next simple routine, but please mind </p>
<p>your language! Try experimenting with numbers and symbol characters too.</p>
<p>Do</p>
<p>Input “Please tell me what to say:”;S$</p>
<p>S$=S$+“.”</p>
<p>Say S$</p>
<p>Loop</p>
<p>If the Narrator system appears to fumble over a particular phrase, you are free to clarify things by </p>
<p>adding spaces at the end of a sentence, or using phonetic spellings. As always, you cannot do any  </p>
<p>harm by experimenting.</p>
<p><b>SET TALK</b></p>
<p><i>instruction: set style of speech</i></p>
<p><b>Set Talk</b> sex,mode,pitch,rate</p>
<p>The easiest way to test this command is to play with its parameters. These are given in the form of  </p>
<p>four values, and any of them can be omitted, providing the relevant commas are in position.</p>
<p>11.02.01</p>
<p>S</p>
<p>P</p>
<p>E</p>
<p>E</p>
<p>C</p>
<p>H</p>
<h1 style="page-break-before:always; "></h1>
<p>Speech</p>
<p>The parameters are as follows:</p>
<p><b>Sex</b> can be set to zero for a male or 1 for a female voice. If you are not satisfied with these alternatives, </p>
<p>zombies, leprechauns and much else besides can be created by playing with the other parameters.</p>
<p>The <b>mode</b> parameter uses zero for normal speech or 1 for a bizarre rhythmic pattern.</p>
<p><b>Pitch</b> is the parameter that changes the audio frequency of the synthetic voice from a deep bass (65) </p>
<p>up to a high soprano (320).</p>
<p>The final  <b>rate</b>  parameter tells AMOS Professional how many average-length words to recite per </p>
<p>minute. This can range from a slow drawl (40) to complete gibberish (400).</p>
<p>Here are some examples:</p>
<p>Set Talk 1,1,, : Say “A rhythmic lady.”</p>
<p>Set Talk 0,0,320,350 : Say “Bubbling fish face.”</p>
<p>Set Talk ,,65,40 : Say “I'm a very lazy bullfrog.”</p>
<p>Set Talk 0,,155,70 : Say “Hello, John Major speaking”</p>
<p><b>TALK MISC</b></p>
<p><i>instruction: set volume and frequency for speech</i></p>
<p><b>Talk Misc</b> volume,frequency</p>
<p>Existing AMOS users will find that the AMOS Professional speech facilities have been augmented and </p>
<p>improved. The TALK MISC command allows you to set the volume and frequency of the narrator </p>
<p>voice used for SAY instructions.</p>
<p>Synthetic   speech   can   be  delivered  from  a  whisper   to  a  shout,   by  setting   the   volume   parameter </p>
<p>between zero for silence, up to 64 for full volume. Frequency is directly adjusted by setting a value </p>
<p>from 5000 to 25000, with some superb effects being generated at slower frequencies. Note that the </p>
<p>higher  the frequency setting, the more processor time will be taken in multitask mode. Try this </p>
<p>example:</p>
<p>For V=16 To 64 Step 8</p>
<p>For F=5000 To 25000 Step 5000</p>
<p>Talk Misc V,F</p>
<p>SAY “I think therefore I AMOS!”</p>
<p>Next F</p>
<p>Next V</p>
<p><b>TALK STOP</b></p>
<p><i>instruction: stop speech in multitask mode</i></p>
<p><b>Talk Stop</b></p>
<p>This simple command is used to terminate synthetic speech delivered by a SAY instruction, while in </p>
<p>multitask mode.</p>
<p>11.02.02</p>
<p>S</p>
<p>P</p>
<p>E</p>
<p>E</p>
<p>C</p>
<p>H</p>
<h1 style="page-break-before:always; "></h1>
<p>Speech</p>
<p><b>The narrator Mouth</b></p>
<p>Another feature of the narrator device exploited by AMOS Professional is the MOUTH system, which </p>
<p>can be displayed in multitask mode only. The MOUTH functions are used to govern the shape and </p>
<p>movement of an animated mouth on screen, as follows:</p>
<p><b>MOUTH WIDTH</b></p>
<p><i>function: return the width of animated mouth</i></p>
<p>width=<b>Mouth Width</b></p>
<p>MOUTH WIDTH reports the width of the mouth at any instant, in pixels. This function will return a </p>
<p>negative value if the current speech has finished.</p>
<p><b>MOUTH HEIGHT</b></p>
<p><i>function: return the height of animated mouth</i></p>
<p>height=<b>Mouth Height</b></p>
<p>Similarly to MOUTH WIDTH, a negative value is returned if the speech is over, otherwise the current </p>
<p>height of the mouth is given in pixels.</p>
<p><b>MOUTH READ</b></p>
<p><i>function: read position of animated mouth</i></p>
<p>position=<b>Mouth Read</b></p>
<p>This function waits for a mouth movement, and then reads the new mouth values directly into the </p>
<p>MOUTH   WIDTH   and   MOUTH   HEIGHT   functions,   as   demonstrated   by   the   usual   ready-   made </p>
<p>example program.</p>
<p>11.02.03</p>
<p>S</p>
<p>P</p>
<p>E</p>
<p>E</p>
<p>C</p>
<p>H</p>
<h1 style="page-break-before:always; "></h1>
<p>Floating Point Numbers</p>
<p>AMOS Professional performs all calculations using the standard library routines available from the </p>
<p>Amiga. These library files are held in the LIBS: directory of your start-up disc.</p>
<p><b>Floating Point Libraries</b></p>
<p>In order to save memory, the floating point libraries are only installed if they are specifically needed </p>
<p>in one of your programs. The first time that a program which contains floating point operations is </p>
<p>tested, AMOS Professional will install the relevant libraries into memory automatically.</p>
<p>Normal floating point operations require the “mathffp.library”, and this is usually available directly </p>
<p>from   ROM,   occupying   about   8k   of   memory   space.   If   your   program   contains   “transcendental” </p>
<p>functions such as SIN, COS or SQR, then AMOS Professional will also load the “mathtrans.library”, </p>
<p>which uses an additional 4k of memory. This is the reason that your disc drive may come to life from </p>
<p>time to time, when a program is tested. Once these libraries have been installed, they will remain in </p>
<p>memory until the end of the current programming session.</p>
<p>Alternatively, if a program is tested using the <b>double precision</b> mode, AMOS Professional will install </p>
<p>the   “mathieeedoubbas.library”   and   “mathieeedoubtrans.library”   files   instead.   These   require   an </p>
<p>additional 23k of valuable memory in order to operate.</p>
<p>Because AMOS Professional uses the standard library routines, all floating point operations speed up </p>
<p>dramatically if a maths co-processor is installed in your Amiga. This will require different library files </p>
<p>from those held on the AMOS Professional start-up disc, and they will only be usable when AMOS </p>
<p>Professional is executed from the CLI or Workbench. If you attempt to boot AMOS Professional </p>
<p>directly from the internal disc drive, you will be limited to the original, slower versions of these </p>
<p>routines.</p>
<p>Here are the formats for single and double precision numbers:</p>
<p><b>Single Precision</b></p>
<p>Accuracy:</p>
<p>7 digits</p>
<p>Range:</p>
<p>1E-14 to 1E+15</p>
<p><b>Double Precision</b></p>
<p>Accuracy:</p>
<p>16 digits</p>
<p>Range:</p>
<p>10E-307 to 10E+308</p>
<p>Floating point numbers are fully discussed in Chapter 5.3, along with an examination of single and </p>
<p>double precision.</p>
<p>11.03.01</p>
<p>F</p>
<p>L</p>
<p>O</p>
<p>A</p>
<p>T</p>
<h1 style="page-break-before:always; "></h1>
<p>Multi-Tasking</p>
<p>AMOS Professional can be run at the same time as totally separate programs and utilities such as </p>
<p>DPaint   III.   This   allows   the   creation   and   testing   of   original  AMOS   Professional   programs   while </p>
<p>drawing on the resources of your favourite audio, graphical and utility items.</p>
<p>Provided that your system has at least one megabyte, multi-tasking is activated by pressing [Amiga]+</p>
<p>[A] to flick between AMOS Professional and the CLI or Workbench environments.</p>
<p>To make effective multi-tasking programs, most of the processing time should not be grabbed, leaving </p>
<p>only a limited amount of processing power for other tasks, and the following command is provided to </p>
<p>solve this problem.</p>
<p><b>MULTI WAIT</b></p>
<p><i>instruction: force a multi-task wait vbl</i></p>
<p><b>Multi Wait</b></p>
<p>The MULTI WAIT instruction should be used in the main loop of an AMOS Professional program. It </p>
<p>forces a multi-task WAIT VBL for situations such as waiting for a menu item to be selected.</p>
<p>This   command   should   not   be   used   to   achieve   accurate   screen   synchronisation,   as   it   has   been </p>
<p>specifically provided for multi-tasking and may skip several vertical blank periods, depending on the </p>
<p>number of tasks being run simultaneously.</p>
<p>The following simple commands are provided to allow complete control over multi-tasking facilities.</p>
<p><b>AMOS TO BACK</b></p>
<p><i>instruction: hide AMOS Professional and reveal the Workbench</i></p>
<p><b>Amos To Back</b></p>
<p>This instruction allows other programs to be accessed, by bringing forward the Workbench display </p>
<p>and hiding AMOS Professional from view.</p>
<p><b>AMOS TO FRONT</b></p>
<p><i>instruction: hide the Workbench and reveal AMOS Professional</i></p>
<p><b>Amos To Front</b></p>
<p>Similarly, this instruction forces AMOS Professional back onto the display, leaving the Workbench </p>
<p>environment hidden.</p>
<p><b>AMOS LOCK</b></p>
<p>instruction: disable [Amiga]+[A] toggle</p>
<p><b>Amos Lock</b></p>
<p>The AMOS LOCK command  disables the  facility  to toggle between AMOS Professional  and the </p>
<p>Workbench by pressing [Amiga]+[A]. This can be used to prevent other users from discovering how </p>
<p>your program was written!</p>
<p>11.04.01</p>
<p>M</p>
<p>U</p>
<p>L</p>
<p>T</p>
<p>I</p>
<p>-</p>
<p>T</p>
<p>A</p>
<p>S</p>
<p>K</p>
<p>I</p>
<p>N</p>
<p>G</p>
<h1 style="page-break-before:always; "></h1>
<p>Multi-Tasking</p>
<p><b>AMOS UNLOCK</b></p>
<p><i>instruction: re-activate toggle between AMOS Professional and Workbench</i></p>
<p><b>Amos Unlock</b></p>
<p>Use   this   instruction   to   restore   the   facility   for   flipping   between   AMOS   Professional   and   the </p>
<p>Workbench, via the [Amiga]+[A] keys.</p>
<p><b>AMOS HERE</b></p>
<p><i>function: report if AMOS Professional is currently at the front of the display</i></p>
<p>status=<b>Amos Here</b></p>
<p>AMOS HERE is used to provide a simple report. A value of -1(True) is returned if AMOS Professional </p>
<p>is currently displayed, otherwise zero (False) indicates that the Workbench is in view.</p>
<p><b>Communication between programs</b></p>
<p>As well as multi-tasking between AMOS Professional and other programs, communication is allowed </p>
<p>between different AMOS Professional programs previously installed in memory.</p>
<p><b>PRUN</b></p>
<p><i>instruction: run a program from memory</i></p>
<p><b>Prun</b> “program name”</p>
<p>This   command   can   be   used   either   from   Direct   Mode   or   from   within   a   program,   and   it   is   a </p>
<p>combination of calling a procedure and running another program. It is also extremely powerful! </p>
<p>When PRUN is called, it has the following effect:</p>
<p>•</p>
<p>A  search   is   made   through   a   program   list   for   the   specified   program   to   be   run,   such   as </p>
<p>“Program_Name.AMOS”.</p>
<p>•</p>
<p>If it isn't found, this program is loaded and then tested.</p>
<p>•</p>
<p>If an error is encountered, an exit will be made to the original program from which PRUN was </p>
<p>called.</p>
<p>•</p>
<p>If everything is in order, all variables are initialised, but the display is left unchanged. All </p>
<p>screens  remain open,  with  any windows and  zones remaining  defined.  Opened files will </p>
<p>remain open for  AmigaDOS, but will appear to be closed to the new program.  The new </p>
<p>program is free to re-open these files.</p>
<p>•</p>
<p>Bobs and Sprites are erased as the Object Bank is changed, and any music will be stopped. </p>
<p>Banks may be passed between programs, however, and this is explained in Chapter 5.9.</p>
<p>•</p>
<p>The new program will now be run.</p>
<p>•</p>
<p>When   the   program  is   over,   or   if   an   error   is   encountered,   an   exit   is   made   to   the  AMOS </p>
<p>Professional program from which PRUN was called.</p>
<p>•</p>
<p>All variable buffers are erased, all files are closed in the program that was called, and Objects </p>
<p>and music will be halted. The screens will remain as they were.</p>
<p>•</p>
<p>If the called program was not originally resident in memory but was loaded, it is now removed </p>
<p>from memory.</p>
<p>•</p>
<p>Control is  returned  to  the  original  program,   at the  position  immediately  after   the  PRUN </p>
<p>command.</p>
<p>11.04.02</p>
<p>M</p>
<p>U</p>
<p>L</p>
<p>T</p>
<p>I</p>
<p>-</p>
<p>T</p>
<p>A</p>
<p>S</p>
<p>K</p>
<p>I</p>
<p>N</p>
<p>G</p>
<h1 style="page-break-before:always; "></h1>
<p>Multi-Tasking</p>
<p>Here is an example of a boot menu, demonstrating a very simple version of this technique:</p>
<p>Do</p>
<p>Screen Open 0,640,200,4,Hires</p>
<p>Repeat</p>
<p>Input “Please enter a program name to run: ”;P$</p>
<p>Exit If P$=“”,2</p>
<p>Trap Prun P$</p>
<p>If Errtrap : Print “Program not found!” : End If</p>
<p>Until Errtrap=0</p>
<p>Wait 50</p>
<p>Loop</p>
<p>•</p>
<p>You may use PRUN to call and run as many programs as memory allows.</p>
<p>•</p>
<p>If there is a SYSTEM instruction in a program called by PRUN,  it will not return to the </p>
<p>Workbench, but back to the previous program.</p>
<p>•</p>
<p>PRUN will work with compiled programs in exactly the same way as outlined above, except </p>
<p>there will be no “.AMOS” appended to the name of the program that is to be loaded and run.</p>
<p>•</p>
<p>The COMMAND LINES reserved variable can be used to send parameters between programs.</p>
<p>•</p>
<p>The BGRAB command can be used to grab banks from the original program to the program </p>
<p>that has been called.</p>
<p>•</p>
<p>If an error is encountered during testing or running, a value will be stored in the PARAM </p>
<p>function, as follows: &lt;0 if there is a test-time error, &gt;0 if there is a run-time error and zero if no </p>
<p>error is encountered at all.</p>
<p>If you are not sure about the display before calling another program with PRUN, simply close all </p>
<p>current screens. This will also free as much memory as possible. Similarly, if you are not sure about </p>
<p>the display after running another program with PRUN, you should also close all of the screens, and </p>
<p>then call the main screen initialisation of your original program again.</p>
<p><b>PRG UNDER</b></p>
<p><i>function: report the availability of a program “under” the current program</i></p>
<p>status=<b>Prg Under</b></p>
<p>This function is used to report on the accessibility of an AMOS Professional program that is “under” </p>
<p>the current program. One of three values can be returned:</p>
<p>Zero indicates that the current program is running normally, under the control of the Editor. Remote </p>
<p>editor commands and BGRAB <b>cannot</b> be used.</p>
<p>A value of 1 indicates that the current program is the only program running, but it is <b>not</b> the program </p>
<p>currently under the control of the Editor. This happens when an accessory program is run or a </p>
<p>“program to menu” option is selected, and remote editor commands are allowed as well as the use of </p>
<p>the BGRAB command.</p>
<p>A value of -1 means that the program has been run via another program, using PRUN. In this case, </p>
<p>memory banks can be grabbed, but remote editor commands <b>cannot</b> be sent.</p>
<p>11.04.03</p>
<p>M</p>
<p>U</p>
<p>L</p>
<p>T</p>
<p>I</p>
<p>-</p>
<p>T</p>
<p>A</p>
<p>S</p>
<p>K</p>
<p>I</p>
<p>N</p>
<p>G</p>
<h1 style="page-break-before:always; "></h1>
<p>Multi-Tasking</p>
<p><b>EXEC</b></p>
<p><i>instruction: send a CLI command to a device</i></p>
<p><b>Exec</b> “CLI Command”,“Output”</p>
<p>The EXEC instruction executes the specified CLI command, via the named output. Output refers to </p>
<p>the name of an AmigaDos device, and is held in inverted commas. If these are empty “”, NIL: will be </p>
<p>used, otherwise the name of the output device must end with a colon.</p>
<p>“CUR:” specifies that the current CLI window is to be used. If this window does not exist, because </p>
<p>AMOS Professional was booted from the Workbench, then the EXEC command cannot operate. If </p>
<p>“CON:” is used, then a CLI window is opened under the Workbench screen, if possible. Any other  </p>
<p>Amiga device can be specified, as long as it is interactive, and it will be opened before the CLI </p>
<p>command is sent, and closed again after the command has been sent, unless it is the current CLI  </p>
<p>window.</p>
<p>For example, to execute an external program copied into the C: directory of AMOS Professional, and </p>
<p>wait for its completion, this could be used:</p>
<p>Amos To Back : Rem Reveal the Workbench</p>
<p>Rem Now launch the program in a small CLI window</p>
<p>Exec “Program Name”,“CON:0/0/160/48/Program Name”</p>
<p>Amos To Front : Rem Return to AMOS Pro after the program</p>
<p><b>PRG STATE</b></p>
<p><i>function: return the status of how the current program was originally run</i></p>
<p>status=<b>Prg State</b></p>
<p>Finally, here is a useful function which gives a report on how the current program was originally run. </p>
<p>PRG STATE can return one of three possible values, as follows:</p>
<p><b>Value</b></p>
<p><b>Meaning</b></p>
<p>0</p>
<p>Program is run under the AMOS Professional Editor</p>
<p>1</p>
<p>Program is run under run-time only</p>
<p>-1</p>
<p>Program is compiled</p>
<p>11.04.04</p>
<p>M</p>
<p>U</p>
<p>L</p>
<p>T</p>
<p>I</p>
<p>-</p>
<p>T</p>
<p>A</p>
<p>S</p>
<p>K</p>
<p>I</p>
<p>N</p>
<p>G</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p>This Chapter deals with the exploitation of the Amiga's operating system, providing a vast range of </p>
<p>possibilities for the experienced system programmer. System libraries are dealt with first, and then </p>
<p>devices are examined.</p>
<p><b>Accessing the system libraries</b></p>
<p>All of the most useful calls to the Amiga's internal system libraries are already built in to AMOS </p>
<p>Professional. You are able to call any library directly from an AMOS Professional program, as well as </p>
<p>access all devices connected to your computer. If you really need to make contact with these libraries </p>
<p>and devices, the following functions are supplied. Please take note that using them without precise </p>
<p>knowledge is a recipe for disaster!</p>
<p>AMOS Professional is able to execute commands from any library installed in your Amiga. These </p>
<p>options use the standard AMOS Professional channel system to deal with Input/Output structures. </p>
<p>Total access to all the standard data structures is also provided via the powerful STRUC function, </p>
<p>which automatically senses the type of element to be manipulated.</p>
<p><b>LIB OPEN</b></p>
<p><i>instruction: open a library for use</i></p>
<p><b>Lib Open</b> channel number,“name.library”,version</p>
<p>The LIB OPEN command calls the OPEN LIBRARY function from EXEC. If the library is external, it </p>
<p>will be loaded into memory from the “Libs:” folder of your current start-up disc. If a problem is </p>
<p>encountered, you will be helped by the relevant error message from AMOS Professional, and the </p>
<p>error can easily be intercepted using a TRAP command.</p>
<p>After the library has been initialised successfully, it remains open until the program is run again from </p>
<p>the Editor, or your variables are re-set using a CLEAR command, or a LIB CLOSE command is called.</p>
<p>Three parameters are needed for a LIB OPEN instruction. The number of a new AMOS Professional </p>
<p>channel, to be used to refer to this library throughout the AMOS Professional program. Then the </p>
<p>name of the library that is to be opened, given in standard Commodore format. Lastly, the minimum </p>
<p>version number of the library that is to be installed in memory should be specified. If you are unsure </p>
<p>of this parameter, use a value of zero.</p>
<p><b>LIB CLOSE</b></p>
<p><i>instruction: close one or all currently open libraries</i></p>
<p><b>Lib Close</b></p>
<p><b>Lib Close</b> <i>channel number</i></p>
<p>Used on its own, the LIB CLOSE command closes all open libraries in a single operation. If an </p>
<p>optional Channel number is included, an individual library may be closed. Please note that if a </p>
<p>selected library does not exist, no error will be reported!</p>
<p><b>LIB CALL</b></p>
<p><i>function: call a function from a library</i></p>
<p>result=<b>Lib Call</b>(channel number,function offset)</p>
<p>This important function acts as the gateway to <b>all</b> the functions in the selected library. It calls </p>
<p>the required function and returns the result to your AMOS Professional program.</p>
<p>11.05.01</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p>The function offset parameter holds the offset value to the library function that you wish to execute, </p>
<p>and   if   it   is   entered   directly   this   value   must   be   exact.   Any   mistakes   will   crash   the   computer. </p>
<p>Alternatively, you are recommended to use a safer method via the LVO function to call the command </p>
<p>by name, which is explained below.</p>
<p>Before calling this function, the appropriate parameter values need to be loaded into the Address and </p>
<p>Data   registers,   using   the  AREG   and   DREG   commands.   The   precise   format   of   these   parameters </p>
<p>depends on the function in question, and should be checked from the appropriate reference manual.</p>
<p>After the function has been successfully executed, any return values will be available for immediate </p>
<p>use from the AREG and DREG variables. Note that AREG only allows the registers from A0 to A3 to  </p>
<p>be accessed. (Registers A4, A5 and A6 are not used by the libraries at all.)</p>
<p><b>LIB BASE</b></p>
<p><i>function: get the base address of the library</i></p>
<p>address=<b>Lib Base</b>(channel number)</p>
<p>LIB BASE is used to return the base address of the selected library. This can be used in conjunction </p>
<p>with the STRUC function to manipulate the internal data structures directly. Obviously, the normal </p>
<p>PEEK and POKE functions can be used for this purpose as well.</p>
<p><b>DOSCALL</b></p>
<p><i>function: execute function from DOS library</i></p>
<p>result=<b>Doscall</b>(function offset)</p>
<p>DOSCALL executes  a  function  directly  from  the  DOS  library,  with  the  offset  to  the  appropriate </p>
<p>function being specified in brackets. The selected command is executed straight from an AMOS </p>
<p>Professional program, without the need to open the DOS library in your program. This is useful for </p>
<p>single calls to an important routine.</p>
<p>The offset value can either be a simple number or a named function using the LVO command. As with </p>
<p>LIB CALL, the control registers first need to be set up carefully. These values should be placed into D0 </p>
<p>to D7 and A0 to A3, with the aid of the AREG and DREG functions. After the command has been </p>
<p>executed, the result will be given as the return value in D0. Please note that the contents of the other </p>
<p>registers will <b>not</b> be loaded back into AREG and DREG.</p>
<p><b>EXECALL</b></p>
<p><i>function: call EXEC library</i></p>
<p>result=<b>Execall</b>(function offset)</p>
<p>The EXECALL function performs a call to the Amiga's EXEC library, with the specified offset value. </p>
<p>On entry, D0 to D7 and A0 to A2 <b>must</b> be loaded with the control settings required by the function. A </p>
<p>value is returned holding the contents of D0.</p>
<p>11.05.02</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p><b>GFXCALL</b></p>
<p><i>function: call Graphics library</i></p>
<p>result=<b>Gfxcall</b>(function offset)</p>
<p>This executes a function directly from the Graphics library, taking the parameters from the DREG and </p>
<p>AREG arrays. The function offset parameter enters the offset to the function you wish to call, and can </p>
<p>also be set using the LVO function, if required.</p>
<p><b>INTCALL</b></p>
<p><i>function: call Intuition library</i></p>
<p>result=<b>Intcall</b>(function offset)</p>
<p>The INTCALL function calls a command directly from the Intuition library. Before using this function, </p>
<p>it is vital to load the appropriate control parameters into the registers D0 to D7 and A0 to A3. This can </p>
<p>be   done   with   the  AREG   and   DREG   variables   from   an  AMOS   Professional   program.   When   the </p>
<p>function has been executed, the contents of D0 will be returned back to your program as the result. </p>
<p>Please note that this function is particularly dangerous, unless you are familiar with the Intuition </p>
<p>library.</p>
<p><b>Equates and Offsets</b></p>
<p>Experienced programmers of C or Assembler languages will be used to calling most library functions </p>
<p>directly, by name. These names are converted invisibly into the appropriate offset values when a </p>
<p>program is compiled into machine code. Unfortunately, this technique only works with compiled </p>
<p>languages. AMOS Professional in an interpreted language, and so a slightly different system has been </p>
<p>adopted.</p>
<p>An   “equate”   is   simply   a   library   function   name   converted   to   its   internal   equivalent.   Instead   of </p>
<p>supplying the usual Include files, equates have been placed in the “AMOSPro.System_Equate” file in </p>
<p>your “AMOSProSystem” folder. The first time a program is tested, the names are converted into their  </p>
<p>internal equivalents by AMOS Professional. Each name is translated into a single value, which is then </p>
<p>saved into a permanent memory bank, ready for instant use.</p>
<p>As you would expect from AMOS Professional, the entire process is completely automatic. Simply </p>
<p>define a memory bank for your equates, and use the LVO, EQU or STRUC functions (explained </p>
<p>below) to return the relevant offset values. Everything else is handled by AMOS Professional.</p>
<p><b>SET EQUATE BANK</b></p>
<p><i>instruction: set up the automatic equate system</i></p>
<p><b>Set Equate Bank</b> bank number</p>
<p>This command allocates a memory bank for use by the automatic equate system. It should be called </p>
<p>up <b>before</b> the first equate in your program, preferably near the beginning. Specify the bank number </p>
<p>to be used for your equates, ranging from 1 to 65535. Any existing bank of the same number will be </p>
<p><b>erased</b> when the equates are installed in memory, without warning, so take care!</p>
<p>11.05.03</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p><b>LVO</b></p>
<p><i>function: get the Library Vector Offset</i></p>
<p>offset=<b>Lvo</b>(“Name_of_the_function”)</p>
<p>This function returns the Library Vector Offset associated with a specified function. The function </p>
<p>name will be translated automatically when your program is tested for the first time, and it will be </p>
<p>placed in a memory bank for future use. Set up the memory bank with a SET EQUATE BANK </p>
<p>command first, otherwise an error message will be generated. If the function name does not exist, an </p>
<p>“Equate not found error” will be given from the Editor.</p>
<p>The function name is in standard Commodore format, and should be typed in exactly as it appears in </p>
<p>your reference manuals. This is especially important regarding the way upper case letters are treated </p>
<p>differently from their lower case equivalents. For example, Input, INPUT and input are separate </p>
<p>keywords, only the first version will be accepted, and either of the alternatives will generate an error </p>
<p>when the program is tested!</p>
<p>Also note that because the function is executed during the testing process, it must be a simple string </p>
<p>rather than an expression. For example, if you need to call the FindTask option from Exec, you would </p>
<p>use a line like this:</p>
<p>TASK=Execall(Lvo(“FindTask”))</p>
<p><b>EQU</b></p>
<p><i>function: get an equate</i></p>
<p>value=<b>Equ</b>(“Name_of_the_equate”)</p>
<p>The EQU function returns any standard equate value used by the Amiga system libraries. The equate </p>
<p>can   represent   anything   from   an   offset   to   a   structure,   or   even   the   names   of   various   bit-   masks. </p>
<p>Provided that it is supplied in the standard Amiga include files, it will be available from AMOS </p>
<p>Professional immediately. The only exceptions to this rule are the library offsets, and these should be </p>
<p>obtained with the LVO function.</p>
<p>The name of the equate should be specified in brackets, and refers to the name as set out in your  </p>
<p>reference manuals. This name is case sensitive, as explained above, so care should be taken. It is also </p>
<p>important to remember that the name string <b>must</b> be a constant, and that expressions are not allowed! </p>
<p>In fact, the technique is extremely simple. This example would send a WRITE command to a device:</p>
<p>DEV D0(channel,EQU(“CMD_WRITE”))</p>
<p><b>STRUC</b></p>
<p><i>reserved variable: access an internal data structure</i></p>
<p>value=<b>Struc</b>(address,“Offset Name”)</p>
<p><b>Struc</b>(address,“Offset_Name”)=value</p>
<p>The STRUC reserved variable provides a simple way of assigning a value to any one of the elements </p>
<p>of a system structure, and it is intelligent!</p>
<p>11.05.04</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p>There can be problems with these structures, because the type of an element varies dramatically from </p>
<p>function to function. Depending on the structure, it can be anything from a single byte to a whole </p>
<p>string   of   characters.   This   means   that   before  an   element   can   be   changed,   the   tedious   process   of </p>
<p>checking its format must be carried out.</p>
<p>STRUC is able to identify the type of the element directly from the equates, and then handle the entire </p>
<p>procedure automatically, no matter if the element is a byte, a word or a longword. If the element is a </p>
<p>string pointer, an error will obviously be generated, but we have provided a STRUC$ variable to cater </p>
<p>for this!</p>
<p>The address parameter holds the address of your structure in memory. This will usually be returned </p>
<p>by a LIB BASE or a DEV BASE function. The offset name is the name of the relevant data object as </p>
<p>listed in your manuals. The name will be converted into an offset number by AMOS Professional, </p>
<p>using the auto-equate system, as explained earlier. This means that a SET EQUATE BANK command </p>
<p>needs to be included near the beginning of your program, to initialise this feature. For example:</p>
<p>Struc(Dev Base(1),“I0_LENGTH”)=TRACK_SIZE</p>
<p>The same process can be used to read a value from a structure:</p>
<p>Print Struc(Dev Base(1),“I0_LENGTH”)</p>
<p><b>STRUC$</b></p>
<p><i>function: read or write a string pointer to a structure</i></p>
<p>value$=<b>Struc$</b>(address,“Offset_Name”)</p>
<p><b>Struc$</b>(address,“Offset Name”)=“value”</p>
<p>This is used to read or write a string of characters to the named structure in  memory. If the element is  </p>
<p>a number, an error will be generated when the program is first tested.</p>
<p>When used to copy a string in a buffer area, STRUC$ adds</p>
<p>a zero to the end, and then LOKEs it. In its alternative use, STRUC$ grabs the string from the relevant </p>
<p>structure address, where this address refers to the address of the structure in memory, as returned by </p>
<p>the LIB BASE or DEV BASE functions.</p>
<p>In both cases, the offset name refers to the name of the item to be manipulated.</p>
<p><b>Adding equates to the equates file</b></p>
<p>If your own non-standard libraries are to be used, equate files can easily be expanded in order to </p>
<p>make use of your new routines.</p>
<p>To achieve this, an assembly listing should be produced, containing the equate definitions in standard </p>
<p>Devpak format. This listing should then be run through the “Equates_Generator.AMOS” program, </p>
<p>which can be found in the root directory of the AMOSPro_System disc.</p>
<p>11.05.05</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p><b>The Requester Extension</b></p>
<p>As a default, the AMOS Professional requester routine will be used in preference to the Workbench </p>
<p>system requester.</p>
<p><b>REQUEST WB</b></p>
<p><i>instruction: use the Workbench system requester</i></p>
<p><b>Request Wb</b></p>
<p>This command is used to switch to the Workbench system requester. As soon as one of the options is </p>
<p>selected   from   it,   you   will   be   returned   to  AMOS   Professional.   Please   note   that   if   the   Requester </p>
<p>Extension is deleted from the extension list by means of the configuration file, then the standard </p>
<p>Workbench requester will be used for displaying messages. This will give the illusion that AMOS </p>
<p>Professional has crashed when a requester appears. If this situation occurs, simply press [Amiga]+[A] </p>
<p>to return to the Workbench, respond to the requester and press [Amiga]+[A] again to return to AMOS </p>
<p>Professional. There should be no need to delete the Requester extension unless memory is very low.</p>
<p><b>REQUEST ON</b></p>
<p><i>instruction: use the AMOS Professional requester routine</i></p>
<p><b>Request On</b></p>
<p>This is the default setting, and is used to make AMOS Professional employ its own requester routine.</p>
<p><b>REQUEST OFF</b></p>
<p><i>instruction: cancel the requester</i></p>
<p><b>Request Off</b></p>
<p>If this instruction is used, AMOS Professional will automatically select the [CANCEL] button of the </p>
<p>requester, and the actual requester will not be displayed. This is ideal for error trapping Within a </p>
<p>program.</p>
<p><b>Control of devices</b></p>
<p>AmigaDOS supports a wide range of devices for your use. Some devices are provided to control  </p>
<p>specific items of hardware, such as printers and disc drives, while others offer access to internal </p>
<p>facilities like the synthetic speech handler. The following two functions need no expert knowledge to </p>
<p>use!</p>
<p><b>DEV FIRST$</b></p>
<p><i>function: get the first device from the current device lis</i></p>
<p>t</p>
<p>device$=<b>Dev First</b>(path$)</p>
<p>This function is similar to DIR FIRST$. A string is returned identifying the first device that satisfies a </p>
<p>chosen search path in the current device list.</p>
<p>DEV FIRST$(“**”) will list everything, DEV FIRST$(“D/**”) will only list disks, and DEV FIRST$</p>
<p>(“A/**”) is used if you only want to list assigns.</p>
<p>11.05.06</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p><b>DEV NEXT$</b></p>
<p><i>function: get the next device that satisfies the current search path</i></p>
<p>device$=<b>Dev Next$</b></p>
<p>This is used in conjunction with the DEV FIRST$ function to get the next device in the current device </p>
<p>list that satisfies the specified search path. Once the last device has been found, an empty string will </p>
<p>be returned.</p>
<p>Print Dev First$(“**”)</p>
<p>Do</p>
<p>A$=Dev Next$</p>
<p>If A$=“” Then End</p>
<p>Print A$</p>
<p>Loop</p>
<p>AMOS Professional includes a powerful series of commands to exploit these devices directly from </p>
<p>your programs, but they should <b>only</b> be used by experienced programmers, armed with the relevant </p>
<p>ROM Kernel manual. You have been warned!</p>
<p><b>DEV OPEN</b></p>
<p><i>instruction: open a device</i></p>
<p><b>Dev Open</b>(channel number,“name.device”,IOlength,UnitNumber,Flags)</p>
<p>The DEV OPEN command opens a communication port and prepares the device for use by AMOS </p>
<p>Professional programs. If this device is not already installed, it will be loaded from the ”DEVS” folder </p>
<p>of your current start-up disc automatically. Floppy disc users may be requested to swap discs at this </p>
<p>point.</p>
<p>The selected device will now remain active during the course of the program, and will only be closed </p>
<p>if a DEV CLOSE command is called, or a RUN command is used to clear the variable area, or a </p>
<p>CLEAR operation is undertaken.</p>
<p>The specified channel number should be from zero to 4, the “name.device” parameter enters the </p>
<p>name of the device to be initialised in normal AmigaDOS format, and IOlength specified the length of </p>
<p>the IO structure to be created for the device. If in doubt, use a value of 256, which should be sufficient  </p>
<p>for most devices. The final flags parameter sets the status of the device flags if applicable. Please refer </p>
<p>to your system documentation for details.</p>
<p>DEV OPEN performs the following operations:</p>
<p>•</p>
<p>Firstly, a communication port is created and initialised.</p>
<p>•</p>
<p>Next, an IO Ext structure is opened, ready for communication.</p>
<p>•</p>
<p>Lastly, the OPEN DEVICE function is executed with the new structure.</p>
<p><b>DEV CLOSE</b></p>
<p><i>instruction: close one or more devices</i></p>
<p><b>Dev Close</b></p>
<p><b>Dev Close</b> <i>channel</i></p>
<p>Use this command to close one or more open devices.</p>
<p>11.05.07</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
<h1 style="page-break-before:always; "></h1>
<p>Libraries and Devices</p>
<p>Memory used by the IO structure will be returned back to AMOS Professional and the message port </p>
<p>is   released   for   subsequent   use.   If   the   channel   number   is   omitted,   all   active   devices   are   closed </p>
<p>simultaneously, otherwise the single specified device is closed down. Note that if a specified channel </p>
<p>is not already open, no error will be reported.</p>
<p><b>DEV DO</b></p>
<p><i>instruction: call a command using DoI0</i></p>
<p><b>Dev Do</b> channel number,command number</p>
<p>The DEV DO instruction executes a DoIO operation via the specified channel. Obviously the correct </p>
<p>internal structure parameters must be set using a STRUC command, before this operation is called. </p>
<p>The specified channel number refers to a previously opened device channel. The command number </p>
<p>holds the number of the IO command you wish to Do. This command may be entered directly by </p>
<p>name, using the EQU function explained earlier. You are warned to take great care when using this </p>
<p>instruction!</p>
<p><b>DEV SEND</b></p>
<p><i>instruction: call a command using SendIO</i></p>
<p><b>Dev Send</b> channel number,command</p>
<p>This calls the SendIO command from Exec, and runs your operation using the Amiga's multi- tasking </p>
<p>system. The new process will run invisibly in the background, and your AMOS Professional program </p>
<p>will continue from the next instruction immediately.</p>
<p><b>DEV CHECK</b></p>
<p><i>function: check status of a device with a CheckIO</i></p>
<p>value=<b>Dev Check</b>(channel number)</p>
<p>Use this function to perform a CheckIO on the specified channel. The resulting value is passed back to </p>
<p>AMOS Professional.</p>
<p><b>DEV ABORT</b></p>
<p><i>instruction: abort an IO operation</i></p>
<p><b>Dev Abort</b> channel number</p>
<p>This instruction executes an AbortIO and a WaitIO command, clearing all pending action from the  </p>
<p>specified device channel. It can be used to exit directly from a multi-tasking operation, without </p>
<p>waiting for it to complete.</p>
<p><b>DEV BASE</b></p>
<p><i>function: get base address of an IO structure</i></p>
<p>address=<b>Dev Base</b>(channel number)</p>
<p>This function returns the base address of the IO structure assigned to the current device. The structure </p>
<p>can now be manipulated directly, using the STRUC commands, as required.</p>
<p>11.05.08</p>
<p>L</p>
<p>I</p>
<p>B</p>
<p>S</p>
<p>/</p>
<p>D</p>
<p>E</p>
<p>V</p>
<p>S</p>
</body>
</html>